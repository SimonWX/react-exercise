### 互联网架构演变
#### 20190712 分享会

##### 一、演变过程
###### 一切以数据为中心
* 数据（高并发环境下）
* 系统瓶颈 ---- 内存 存储 网络 CPU
* B/S(https | http)
    * PV (page view)
    * UV (unique vistor)
    * IP (Internet protocol)
    * TPS(吞吐量，单位时间内处理请求数量)
    * 并发用户数(系统可同时承载的正常使用系统功能的用户数量)
    * QPS(Query Per Second)
    * RT(响应时间)
* keep-alive (websokect)


第一阶段 
* Apache && mysql && nginx

+ +缓存机制 storage / cookies / indexDB 
+ +动态缓存机制 （CSI 、SSI、ESI）缓存改变极小的数据段

第二阶段
+ nginx 代理（反向），负载均衡（让请求均匀的分配在服务器端） 
+ 添加webserver机器
+ 如何保持状态信息的同步？基于cookie的session共享，&& memcache的session共享
+ 如何保存数据缓存的信息同步？

第三阶段
+ 分库
+ 分表
+ 读写分离
+ CDN（静态资源分布），DNS，VIP平滑漂移 and so on



##### 二、结构的高可用和高并发
###### 高可用

* 负载均衡
* 限流
* 降级（自动、手动）
    * 熔断降级
    * 数据降级
* 隔离（爬虫隔离，线程）
* 超时 && 重试
    * 前端重试
    * 服务容器
* 回滚（online服务器）
* 压力测试
* 预案
 
###### 高并发
* 缓存
    * http缓存
    * 多级、分布式存储
    * 应用级别缓存
* 池化 （心跳重连）
* 异步
    * 请求合并
    * 异步further && callback
* 扩容
    * 应用扩容
    * 应用拆分
    * 数据 水平/垂直拆分
    * 任务系统扩容/分布式在线
    * sharding-jdbc读写分离
* 队列
    * 解耦
    * 消峰
    * 串行


##### 架构设计的6大原则
* 单一职责
* 依赖倒转
* 里式替换
* 开闭原则
* 接口隔离
* 迪米特
* 一切架构设计要以业务需求为导向